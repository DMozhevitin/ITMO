# A. Автоматная грамматика

Дана автоматная грамматика, задающая язык L. Дан набор слов {wi}
m
i=1. Для каждого слова
wi требуется определить, принадлежит ли оно языку L.

**Формат входных данных**

В первой строке задано n — число продукций и стартовый символ. Следующие n строк содержат
продукции вида либо Ai → biCi
, либо Ai → bi
. В следующей строке задано число слов m, которые
требуется проверить. Далее следуют m строк, содержащих слова wi (1 6 n 6 100, 1 6 m 6 20,
1 6 wi 6 10000).
Каждый нетерминальный символ представлен в виде большой буквы латинского алфавита, а
терминальный — маленькой. Все слова состоят только из маленьких букв латинского алфавита.

**Формат выходных данных**

Для каждого wi выведите «yes», если слово принадлежит языку, или «no» в противном случае

# B. ε-продукции

Дана КС-грамматика. Найдите все нетерминалы, из которых выводится ε.

**Формат входных данных**

В первой строке задано число продукций n и стартовый символ. Следующие n строк содержат
продукции вида Ai → Ni
, где Ai — нетерминал, а Ni — строка из терминалов и нетерминалов
(1 6 n 6 100, 0 6 |Ni
| 6 50).
Каждый нетерминальный символ представлен в виде большой буквы латинского алфавита, а
терминальный — маленькой. Строка Ni может быть пустой.

**Формат выходных данных**

Выведите через пробел в лексикографическом порядке множество нетерминалов, из которых
выводится ε.

# C. Бесполезные символы

Дана КС-грамматика. Найдите все бесполезные нетерминалы. Напомним, что нетерминал называется бесполезным, если он является либо недостижимым, либо непорождающим.

**Формат входных данных**

В первой строке задано число продукций n и стартовый символ. Следующие n строк содержат
продукции вида Ai → wi
, где Ai — нетерминал, а Ni — строка из терминалов и нетерминалов
(1 6 n 6 100, 0 6 |Ni
| 6 50).
Каждый нетерминальный символ представлен в виде большой буквы латинского алфавита, а
терминальный — маленькой. Строка Ni может быть пустой.

**Формат выходных данных**

Выведите через пробел в лексикографическом порядке множество бесполезных символов.

# D. НФХ

Дана КС-грамматика в нормальной форме Хомского. Дано слов w. Требуется посчитать количество способов вывести w в заданной грамматике. Напомним, что грамматика находится в нормальной форме Хомского, если любая ее продукция имеет вид либо A → BC, либо A → a.

**Формат входных данных**

В первой строке задано число продукций n и стартовый символ. Следующие n строк содержат
продукции вида либо Ai → BiCi
, либо Ai → ai
, где Ai
, Bi
, Ci — нетерминалы, а ai — терминал. В
следующей строке задано слово w (1 6 n 6 100, 1 6 |w| 6 100).
Каждый нетерминальный символ представлен в виде большой буквы латинского алфавита, а
терминальный — маленькой. Слово w состоит только из маленьких букв латинского алфавита.

**Формат выходных данных**

Для каждого wi выведите число способов породить слово в заданной грамматике по модулю
1000000007.

# E. КС-грамматика

Дана КС-грамматика, задающая язык L. Дано слово w. Определить, принадлежит ли слово w
языку L.

**Формат входных данных**

В первой строке задано число продукций n и стартовый символ. Следующие n строк содержат
продукции вида Ai → Ni
, где Ai — нетерминалы, а Ni — строка из терминалов и нетерминалов. В
следующей строке задано слово w (1 6 n 6 50, 0 6 |Ni
| 6 5, 1 6 |w| 6 100).
Каждый нетерминальный символ представлен в виде большой буквы латинского алфавита, а
терминальный — маленькой. Все слова состоят только из маленьких букв латинского алфавита.
Строка Ni может быть пустой.

**Формат выходных данных**

Для каждого wi выведите «yes», если слово принадлежит языку, или «no» в противном случае.

