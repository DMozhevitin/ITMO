2

S 0 _ -> S 0 > 0 >
S 1 _ -> S 1 > 1 >
S a _ -> ca a ^ _ <
S o _ -> co o ^ _ <
S _ _ -> clean _ < _ ^ 

ca a 1 -> ca1 a ^ _ <
ca a 0 -> ca0 a ^ _ <

ca1 a 1 -> S a > 1 >
ca1 a 0 -> S a > 0 >

ca0 a 1 -> S a > 0 >
ca0 a 0 -> S a > 0 >
  
co o 1 -> co1 o ^ _ <
co o 0 -> co0 o ^ _ <

co1 o 1 -> S o > 1 >
co1 o 0 -> S o > 1 >

co0 o 0 -> S o > 0 >
co0 o 1 -> S o > 1 >  

clean 0 _ -> clean _ < _ ^
clean 1 _ -> clean _ < _ ^
clean a _ -> clean _ < _ ^
clean o _ -> clean _ < _ ^
clean _ _ -> getans _ ^ _ <

getans _ 1 -> AC 1 ^ _ ^
getans _ 0 -> AC 0 ^ _ ^
